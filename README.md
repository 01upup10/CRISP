# CRISP: Contrastive Residual Injection and Semantic Prompting for Continual Video Instance Segmentation
**Author**: Baichen Liu, Qi Lyu, Xudong Wang, Jiahua Dong, Lianqing Liu, Zhi Han

## ðŸš€News


>Continual video instance segmentation demands both the plasticity to absorb new object categories and the stability to retain previously learned ones, all while preserving temporal consistency across frames. In this work, we introduce Contrastive Residual Injection and Semantic Prompting (CRISP), an earlier attempt tailored to address the instance-wise, category-wise, and task-wise confusion in continual video instance segmentation. For instance-wise learning, we model instance tracking and construct instance correlation loss, which emphasizes the correlation with the prior query space while strengthening the specificity of the current task query. For category-wise learning, we build an adaptive residual semantic prompt (ARSP) learning framework, which constructs a learnable semantic residual prompt pool generated by category text and uses an adjustive query-prompt matching mechanism to build a mapping relationship between the query of the current task and the semantic residual prompt. Meanwhile, a semantic consistency loss based on the contrastive learning is introduced to maintain semantic coherence between object queries and residual prompts during incremental training. For task-wise learning, to ensure the correlation at the inter-task level within the query space, we introduce a concise yet powerful initialization strategy for incremental prompts. Extensive experiments on YouTube-VIS-2019 and YouTube-VIS-2021 datasets demonstrate that CRISP significantly outperforms existing continual segmentation methods in the long-term continuous video instance segmentation task, avoiding catastrophic forgetting and effectively improving segmentation and classification performance.

<img width="1716" height="1014" alt="fig_main" src="https://github.com/user-attachments/assets/ea94b90a-6a25-424f-bdbc-31e94465bd9e" />


## ðŸ“š Benchmark for CVIS

### YouTubeVIS 2019

| **Model** | Setting |                  **mAP**                  |                 **AP50**                  |                 **AP75**                  |                  **AR1**                  |                 **AR10**                  |                  **FR**                  |
| :-------: | :-----: | :---------------------------------------: | :---------------------------------------: | :---------------------------------------: | :---------------------------------------: | :---------------------------------------: | :--------------------------------------: |
|    FT     |  20-4   |                   6.53                    |                   11.39                   |                   6.96                    |                   11.59                   |                   11.99                   |                  21.19                   |
|    MiB    |  20-4   |                   9.01                    |                   17.75                   |                   7.29                    |                   14.03                   |                   24.34                   |                  17.78                   |
| CoMFormer |  20-4   |                   12.76                   |                   24.43                   |                   11.08                   |                   16.85                   |                   26.22                   |                   13.6                   |
|  ECLIPSE  |  20-4   | **<span style="color:blue">25.03</span>** | **<span style="color:blue">39.83</span>** | **<span style="color:blue">27.59</span>** | **<span style="color:blue">32.81</span>** | **<span style="color:blue">40.48</span>** | **<span style="color:blue">2.23</span>** |
|  CoMBO   |  20-4   |                   15.8                    |                   29.40                   |                   16.6                    |                   25.54                   |                   28.55                   |                  16.05                   |
|   CRISP   |  20-4   |  **<span style="color:red">28.1</span>**  |  **<span style="color:red">43.3</span>**  | **<span style="color:red">31.98</span>**  | **<span style="color:red">38.04</span>**  | **<span style="color:red">44.71</span>**  | **<span style="color:red">1.93</span>**  |
|    FT     |  20-2   |                   3.72                    |                   6.61                    |                   4.27                    |                   9.67                    |                   10.13                   |                  15.56                   |
|   MiB    |  20-2   |                   0.94                    |                   2.07                    |                   0.91                    |                   3.58                    |                   5.86                    |                  16.26                   |
| CoMFormer |  20-2   |                   5.26                    |                   9.01                    |                   5.32                    |                   9.57                    |                   12.01                   |                   11.4                   |
|  ECLIPSE  |  20-2   | **<span style="color:blue">19.09</span>** | **<span style="color:blue">29.05</span>** | **<span style="color:blue">21.81</span>** | **<span style="color:blue">26.06</span>** | **<span style="color:blue">31.92</span>** | **<span style="color:blue">3.21</span>** |
|   CoMBO   |  20-2   |                   4.37                    |                   8.17                    |                   4.25                    |                   9.59                    |                   10.71                   |                  15.02                   |
|   CRISP   |  20-2   | **<span style="color:red">25.14</span>**  | **<span style="color:red">37.46</span>**  | **<span style="color:red">28.17</span>**  | **<span style="color:red">32.87</span>**  | **<span style="color:red">39.13</span>**  | **<span style="color:red">1.13</span>**  |

### YoutubeVIS 2021

| **Model** | Setting |                  **mAP**                  |                 **AP50**                  |                 **AP75**                  |                  **AR1**                  |                 **AR10**                  |                  **FR**                  |
| :-------: | :-----: | :---------------------------------------: | :---------------------------------------: | :---------------------------------------: | :---------------------------------------: | :---------------------------------------: | :--------------------------------------: |
|    FT     |  20-5   |                   4.08                    |                   6.90                    |                   4.52                    |                   6.43                    |                   7.36                    |                  32.63                   |
|    MiB    |  20-5   |                   5.82                    |                   10.87                   |                   4.49                    |                   9.52                    |                   15.96                   |                  25.44                   |
| CoMFormer |  20-5   |                   14.49                   |                   28.01                   |                   14.46                   |                   23.01                   |                   30.15                   |                  10.58                   |
|  ECLIPSE  |  20-5   | **<span style="color:blue">22.26</span>** | **<span style="color:blue">33.39</span>** | **<span style="color:blue">24.74</span>** | **<span style="color:blue">24.81</span>** | **<span style="color:blue">31.03</span>** | **<span style="color:blue">5.03</span>** |
|   CoMBO   |  20-5   |                   15.35                   |                   25.18                   |                   16.40                   |                   24.01                   |                   29.39                   |                  19.88                   |
|   CRISP   |  20-5   | **<span style="color:red">26.13</span>**  | **<span style="color:red">39.13</span>**  | **<span style="color:red">28.82</span>**  | **<span style="color:red">28.84</span>**  | **<span style="color:red">37.49</span>**  | **<span style="color:red">4.38</span>**  |
|    FT     |  10-10  |                   5.12                    |                   10.24                   |                   4.54                    |                   7.97                    |                   9.34                    |                  42.96                   |
|    MiB    |  10-10  |                   8.14                    |                   13.03                   |                   9.06                    |                   10.11                   |                   12.25                   |                  24.95                   |
| CoMFormer |  10-10  |                   12.83                   |                   23.35                   |                   13.19                   |                   16.92                   |                   26.14                   |                  23.67                   |
|  ECLIPSE  |  10-10  |                   19.04                   |                   30.94                   |                   19.92                   | **<span style="color:blue">25.4</span>**  |                   32.06                   | **<span style="color:blue">4.38</span>** |
|   CoMBO   |  10-10  | **<span style="color:red">20.29</span>**  | **<span style="color:red">33.94</span>**  | **<span style="color:red">21.58</span>**  | **<span style="color:red">26.19</span>**  | **<span style="color:red">33.64</span>**  |                  19.75                   |
|   CRISP   |  10-10  | **<span style="color:blue">20.05</span>** | **<span style="color:blue">31.82</span>** | **<span style="color:blue">21.54</span>** |                   25.26                   | **<span style="color:blue">32.71</span>** | **<span style="color:red">2.73</span>**  |

